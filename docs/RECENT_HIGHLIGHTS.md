# Recent Highlights

- Added a Langtext JSON editor and detail viewer so key/value metadata renders clearly in the UI while falling back to the legacy text renderer when parsing fails.
 
- Moved the detailed activities feed to `/activities` while limiting the landing page card to the latest three events with a shortcut link.
- Trimmed the workspace `package-lock.json` by removing the accidental `npm` runtime dependency; regenerate with `npm install --package-lock-only` once registry access is restored (currently blocked by 403s in this environment).
- Expanded the localized event label maps to cover newly tracked agentic lifecycle steps so UI timelines render translated copy for every restart, cancelation, and QR scan.
- Corrected the backend media directory resolution to keep item image persistence working after build outputs move into `dist/backend`.
- Enhanced the Node-based test harness with Jest-style utilities, enabling async-friendly matchers and richer diagnostics when running `node scripts/run-tests.js`.
- Added a manual fallback control to the agentic item creation form so users can exit to manual editing while preserving draft data.
- Introduced the shared `LoadingPage` experience on landing and item list routes so top-level pages display a consistent loading state while fetching data.
- Ensured item categories persist and round-trip correctly even without Artikelnummer assignments, with logging to surface missing metadata.
- Item and box label printing now share a single PDF per request, leave previews downloadable, and route jobs through the configured CUPS queue with structured error reporting.
- Added backend support to remove items from boxes and delete items or boxes via new API endpoints.
- Exposed removal and deletion controls in the React UI and made stock counts read-only when editing items.
- Wrapped removal and deletion in database transactions and added unit tests to verify item stock and box deletion logic.
- Extended existing move and save/import actions to use database transactions for atomic updates and event logging.
- Introduced a CSV export endpoint with date filters for item data.
- Added an admin endpoint (`POST /api/agentic/queue`) that bulk-queues agentic runs with `mode` filtering (`all` vs `missing`) and logs each queued item for audit history.
- Box and item IDs now follow the `B-ddMMyy-####` / `I-ddMMyy-####` pattern.
- Added an API and React page to list all items, linked from the search card.
- Confirmed inventory adjustments, styled item lists for mobile, added filter for unplaced items, and disabled UI during CSV uploads with automatic reload.
- CSV validation now reports the number of parsed items and boxes.
- Styled the AddItemToBoxDialog modal using shared card classes for a consistent look.
- Reintroduced Box IDs on overview and box detail cards, aligned CSV export columns with import format, restyled the add-item dialog text color, and switched list views to short `dd.MM.yyyy` dates.
- Persisted up to three item images to `media/{ItemId}` and stored the first image path in `Grafikname`.
- Warn users when deleting a non-empty Behälter and translate UI text from "Box" to "Behälter" throughout.
- Statistics now show "Artikel ohne Behälter" and list pages use `dd.MM.yyyy` dates.
- Item details now show the creator and current stock, remove the Standort field, and events list include article numbers and descriptions.
- Images persist across item edits with `{Artikelnummer}-{imgNumber}` naming, and item models no longer carry picture fields.
- Restored agentic search-query storage using the streamlined `backend/db.ts` schema and the new `upsertAgenticRun` helper.
- Updated the item creation workflow to trigger agentic runs asynchronously via `frontend/src/components/ItemCreate.tsx` while `backend/actions/import-item.ts` handles persistence and image writes.
- Updated item creation imports to split Stk quantities into per-instance rows while keeping Menge (Mix) quantities on a single item, with added logging for chosen modes and created counts.
- Added legacy CSV schema detection, normalized Stück quantities into per-item instances, and renamed the Mix unit to Menge for grouped inventory tracking.
- Replaced the print label action with a non-navigating control and added modal logging around item label printing.
- Added compact header icon navigation for create/items/boxes/activities and removed redundant card-level links now covered by the header.
- Hardened box ID sequencing to filter B-prefixed IDs and retry on collisions with warning logs.
- Added Artikel_Nummer to the import-item success payload and aligned the item creation dialog with response-backed metadata while logging missing response fields.
- Centralized item category lookup builders in shared models so backend and frontend reuse the same map logic.
- Updated unified print label actions to use shared category lookups with backend-safe imports and contextual error logging.
- Enriched the item creation success dialog with Artikelnummer context and a direct label print action for faster follow-up.
- Added a UI action in item detail to close in-progress agentic runs and unblock queued approvals.
- Updated item detail neighbor navigation to respect saved list filters when resolving adjacent items.
- Re-enabled the Unterkategorie filter on the item list, persisted subcategory selections, and added backend query support to avoid client-only filtering for large lists.
- Swapped the Unterkategorie filter input for taxonomy-backed select options and logged missing subcategory selections to keep filters resilient.
- Mapped Langtext Qualität labels back into the numeric Quality field during CSV/form imports while cleaning the Langtext payloads.
- Split item list box vs. shelf normalization so Behälter and Lagerort links only render with their respective IDs.
- Removed the default-location relocation button and API option so item moves always target an explicit box selection.
- Updated shelf creation to resolve category labels from taxonomy lookups with fallback logging, and removed legacy category seeding now that CSV imports will own this workflow.
- Added shelf box detail payloads that surface contained boxes and render them in the UI detail view alongside items.
- Switched ERP sync imports to a curl-based multipart upload that matches the ERP payload fields and timeout semantics.
- Added a minimal pricing stage in the agentic item flow with a dedicated pricing rules prompt to align Verkaufspreis handling across prompts and schemas.
- Reordered the agentic item flow so the pricing stage runs before supervisor review feedback is generated.
- Guarded the pricing stage with a timeout so supervisor review continues when pricing stalls.
- Added a shelf creation form in the box list UI backed by shared shelf location metadata for consistent ID generation.
- Added a hidden admin shelf creation route with stronger validation and logging around shelf location selections.
- Updated shelf creation to require subcategory selection so shelf IDs carry numeric category codes.
- Filtered relocation shelf dropdowns by category-aware shelf IDs so box relocations surface relevant shelves faster.
- Removed box detail label editing from the note workflow so note-only updates preserve stored labels.
- Added shelf creation payload handling with prefix-based sequencing for shelf IDs.
- Added an A4 shelf label print template to prepare for shelf-specific print endpoints.
- Expanded activities search matching to include box/shelf identifiers and clarified the search hint copy.
- Wired the A4 shelf label print template into the box print action with shelf category resolution for QR payloads.
- Made agentic search plan and per-request query limits configurable via env settings for the item flow pipeline.
- Added CSV import alias coverage for ItemUUID/Auf Lager headers and hardened boxes-only ingestion logging.
- Added a bulk “Sync to ERP” action button on the item list to trigger `/api/sync/erp` with selected IDs.
- Added camera capture support in item forms so photos can be captured directly into data URLs.
- Persisted item list filter preferences with a header reset indicator to keep search context between visits.
- Added a review-time fallback that assigns `Verkaufspreis` from the category/type lookup table when approvals finish without a price.
- Normalized CSV exports to emit canonical category labels when serializing category codes for partner payloads.
- Padded exported `Artikel-Nummer` values to a six-digit format for downstream CSV consumers.
- Introduced activities search entry points on the recent events card and activities page for quicker refinement.
- Added optional search-term filtering for the recent activities feed based on entity or article identifiers.
- Wired the activities search term into the activities page API request so filtering updates with the URL state.
- Update the closing of larger tasks in [RECENT_HIGHLIGHTS]()
- Introduced topic-based event log allowlists across backend and frontend feeds, defaulting to full visibility unless configured.
- Introduced default shelf location mapping configuration for subcategory-backed location IDs, logging missing mappings to protect data quality.
- Added shelf BoxID format validation for boxes.csv ingestion to warn and skip malformed shelf IDs.
- Simplified box location tags in the UI to show normalized locations and optional labels without color mapping.
- Added a dedicated 29x90 item label template and routed item print jobs to it for the new item label format.
- Filtered the Behälter list view to exclude shelf records so shelves no longer appear as boxes.
- Filtered shelf box detail payloads to hide shelf records from the Behälter card while logging filtered counts.
- Clarified relocate-box shelf dropdown labels by splitting shelf IDs into location, floor, and shelf number segments.
- Wired the recent activities term filter helper into the action context with fallback logging.
- Normalized printer status responses with ok/reason data and surfaced printer misconfiguration hints in the overview UI.
- Derived shelf display labels in the box list using shelf location metadata for clearer shelf rows.
- Added a manual agentic review close endpoint to approve items without existing agentic runs and log the closure reason.
- Updated the 62x100 box label template to render a bold box ID with a large QR code for box-specific printing.
- Unified label printing behind `/api/print/:labelType/:id` while keeping thin box/item wrappers for migration.
- Added a frontend auto-print toggle for item creation flows, with shared label request handling and configuration logging.
- Refined the item list filter bar layout to render side-by-side controls with better alignment across responsive breakpoints.
- Wrapped the item list filter controls into primary and secondary panels with consistent grid wrappers for cleaner alignment.
- Added grid-based filter panel styling to keep filter controls aligned within responsive boxes.
- Updated stock mutation endpoints to create/delete Stück item instances while keeping Menge bulk quantity adjustments with richer logging.
- Enabled manual agentic run closes even when runs are marked as not started after import/export cycles.
- Blocked item editing while agentic runs are active in the item detail and edit flows.

